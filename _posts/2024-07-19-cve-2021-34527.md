---
layout: app
title: "PrintNigthmare"
tags: ["PrintNigthmare","cve-2021-34527", "Windows", "AD","Print Spool Service", "CVE-2021-1675","Local Privilege Scalation"]

---

# PrintNigthMare

This is a vulnerability that allows the use of the Windows Spooler Service to run remote code

## Detect 

```python
impacket-rpcdump @<IP> | grep -E 'MS-RPRN|MS-PAR'

Protocol: [MS-PAR]: Print System Asynchronous Remote                     
Protocol: [MS-RPRN]: Print System Remote Protocol

```

[https://www.sygnia.co/threat-reports-and-advisories/demystifying-the-print-nightmare-vulnerability/](https://www.sygnia.co/threat-reports-and-advisories/demystifying-the-print-nightmare-vulnerability/)

## CVE-2021-34527 (LPE)

[https://github.com/JohnHammond/CVE-2021-34527/tree/master](https://github.com/JohnHammond/CVE-2021-34527/tree/master)

## CVE-2021-1675 (RCE)

[https://github.com/cube0x0/CVE-2021-1675/tree/main](https://github.com/cube0x0/CVE-2021-1675/tree/main)